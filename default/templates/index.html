<!doctype html>
<!--
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
  <head>
    <title>core-drawer-panel</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <script src="bower_components/webcomponentsjs/webcomponents.js"></script>

    <link rel="import" href="bower_components/core-drawer-panel/core-drawer-panel.html">
    <link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
    <link rel="import" href="bower_components/core-header-panel/core-header-panel.html">
    <link rel="import" href="bower_components/core-scroll-header-panel/core-scroll-header-panel.html">
    <link rel="import" href="bower_components/core-toolbar/core-toolbar.html">
    <link rel="import" href="bower_components/core-menu/core-menu.html">
    <link rel="import" href="bower_components/core-item/core-item.html">

    <style>

      html, body {
        height: 100%;
      }

      body {
        font-family: 'Roboto', sans-serif;
        margin: 0px;
        background-color: #ececec;
      }

      [drawer] {
        background-color: #fff;
      }

      core-header-panel {
        height: 100%;
      }

      #content {
        height: 10000px;
        display: none;
      }

      #intro {
        background-color: red;
      }

      #about {
        height: 1000px;
        background-color: blue;
      }

      #maintoolbar {
        background-color: transparent;
      }

      #pageScroll {
        text-decoration: none;
        color: #000;
      }

      core-drawer-panel {
        position:fixed;

      }

      #menu {
        height: 1000px;
      }

    </style>

  </head>

  <body unresolved>

    <core-drawer-panel id="drawer" forceNarrow>
      <core-header-panel drawer>
        <core-toolbar>
          <span>Menu</span>
        </core-toolbar>
        <core-menu id="menu">
          <core-item label="One"></core-item>
          <core-item label="Two"></core-item>
        </core-menu>
      </core-header-panel>

      <core-toolbar id="maintoolbar" main>
        <paper-icon-button icon="menu" core-drawer-toggle></paper-icon-button>
        <span>Header</span>
        <a id="pageScroll" href="#about"><paper-icon-button icon="menu"></paper-icon-button></a>
      </core-toolbar>

    </core-drawer-panel>
    <div id="content">
      <section id="intro">

      </section>
      <section id="about">

      </section>
    </div>

    <!-- Core JavaScript Files -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

    <script>
      $(document).ready(function() {
        // Adjust heights of intro and connect sections
        var height = $(window).height();
        if ($("#intro").height() < height){
          $("#intro").height(height);
        }

        $("#content").show();

        //jQuery for page scrolling feature - requires jQuery Easing plugin
        $(function() {
            $('#pageScroll').bind('click', function(event) {
                var $anchor = $(this);
                $('html, body').stop().animate({
                    scrollTop: $($anchor.attr('href')).offset().top
                }, 1500, 'easeInOutExpo');
                event.preventDefault();
            });
        });

        var selected = "main";

        document.querySelector('core-drawer-panel').addEventListener('core-select', function (event) {
          if (selected != event.detail.item.id) {
            if (selected == "main"){
              // lock scroll position, but retain settings for later
              var scrollPosition = [
                self.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft,
                self.pageYOffset || document.documentElement.scrollTop  || document.body.scrollTop
              ];
              var html = jQuery('html'); // it would make more sense to apply this to body, but IE7 won't have that
              html.data('scroll-position', scrollPosition);
              html.data('previous-overflow', html.css('overflow'));
              html.css('overflow', 'hidden');
              window.scrollTo(scrollPosition[0], scrollPosition[1]);

              selected = "drawer";
            }
            else {
              // un-lock scroll position
              var html = jQuery('html');
              var scrollPosition = html.data('scroll-position');
              html.css('overflow', html.data('previous-overflow'));
              window.scrollTo(scrollPosition[0], scrollPosition[1]);

              selected = "main";
            }
          }
        });

      });
    </script>
  </body>
</html>
